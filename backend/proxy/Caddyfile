# All requests will come to our proxy's default URL, so we don't need a domain name here.
:{$PORT} {
    # Redirect all requests to the root path to /portfolio
    redir / /portfolio 301
    # Route requests for /hello to the "hello" service
    handle_path /hello* {
        reverse_proxy {$HELLO_SERVICE_URL} {
            header_up Host {http.reverse_proxy.upstream.hostport}
            header_up X-Forwarded-Proto https
        }
    }

    # Route requests for /portfolio to the "portfolio" service
    handle_path /portfolio* {
        # Proxy the request to the portfolio service.
        reverse_proxy {$PORTFOLIO_SERVICE_URL} {
            header_up Host {http.reverse_proxy.upstream.hostport}
            header_up X-Forwarded-Proto https
        }
    }
}